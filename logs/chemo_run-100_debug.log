2025-04-10 15:27:06.972 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:27:06.972 INFO: MACE version: 0.3.6
2025-04-10 15:27:06.972 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:27:06.998 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:27:07.016 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:27:07.024 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:27:07.035 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:27:07.041 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:27:07.041 INFO: 
2025-04-10 15:27:07.041 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:27:07.176 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:27:07.176 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:27:07.177 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:27:07.177 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:27:07.177 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:27:07.180 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:27:07.271 INFO: 
2025-04-10 15:27:07.271 INFO: ===========MODEL DETAILS===========
2025-04-10 15:27:07.800 INFO: Average number of neighbors: 22.2
2025-04-10 15:27:07.800 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:27:07.873 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:27:07.873 INFO: Building model
2025-04-10 15:27:07.873 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:27:07.873 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:27:07.873 INFO: 8 radial and 5 basis functions
2025-04-10 15:27:07.873 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:27:07.873 INFO: Distance transform for radial basis functions: None
2025-04-10 15:27:08.841 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:27:08.841 INFO: Total number of parameters: 68960
2025-04-10 15:27:08.842 INFO: 
2025-04-10 15:27:08.842 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:27:08.842 INFO: Using ADAM as parameter optimizer
2025-04-10 15:27:08.842 INFO: Batch size: 10
2025-04-10 15:27:08.842 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:27:08.842 INFO: Number of gradient updates: 102000
2025-04-10 15:27:08.842 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:27:08.842 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:27:08.842 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:27:08.842 INFO: 
2025-04-10 15:27:08.842 INFO: ===========TRAINING===========
2025-04-10 15:27:08.842 INFO: Started training, reporting errors on validation set
2025-04-10 15:27:08.842 INFO: Loss metrics on validation set
2025-04-10 15:28:16.369 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:28:16.370 INFO: MACE version: 0.3.6
2025-04-10 15:28:16.370 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:28:16.396 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:28:16.414 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:28:16.421 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:28:16.433 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:28:16.439 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:28:16.439 INFO: 
2025-04-10 15:28:16.439 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:28:16.574 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:28:16.574 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:28:16.574 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:28:16.574 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:28:16.574 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:28:16.577 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:28:16.669 INFO: 
2025-04-10 15:28:16.669 INFO: ===========MODEL DETAILS===========
2025-04-10 15:28:17.176 INFO: Average number of neighbors: 22.2
2025-04-10 15:28:17.176 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:28:17.249 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:28:17.250 INFO: Building model
2025-04-10 15:28:17.250 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:28:17.250 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:28:17.250 INFO: 8 radial and 5 basis functions
2025-04-10 15:28:17.250 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:28:17.250 INFO: Distance transform for radial basis functions: None
2025-04-10 15:28:18.139 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:28:18.140 INFO: Total number of parameters: 68960
2025-04-10 15:28:18.140 INFO: 
2025-04-10 15:28:18.140 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:28:18.140 INFO: Using ADAM as parameter optimizer
2025-04-10 15:28:18.140 INFO: Batch size: 10
2025-04-10 15:28:18.140 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:28:18.140 INFO: Number of gradient updates: 102000
2025-04-10 15:28:18.140 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:28:18.140 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:28:18.141 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:28:18.141 INFO: 
2025-04-10 15:28:18.141 INFO: ===========TRAINING===========
2025-04-10 15:28:18.141 INFO: Started training, reporting errors on validation set
2025-04-10 15:28:18.141 INFO: Loss metrics on validation set
2025-04-10 15:29:03.051 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:29:03.051 INFO: MACE version: 0.3.6
2025-04-10 15:29:03.051 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:29:03.078 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:29:03.095 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:03.103 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:03.115 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:29:03.120 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:29:03.120 INFO: 
2025-04-10 15:29:03.121 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:29:03.257 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:29:03.257 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:29:03.258 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:29:03.258 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:29:03.258 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:29:03.260 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:29:03.353 INFO: 
2025-04-10 15:29:03.353 INFO: ===========MODEL DETAILS===========
2025-04-10 15:29:03.880 INFO: Average number of neighbors: 22.2
2025-04-10 15:29:03.880 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:29:03.955 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:29:03.955 INFO: Building model
2025-04-10 15:29:03.955 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:29:03.955 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:29:03.955 INFO: 8 radial and 5 basis functions
2025-04-10 15:29:03.955 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:29:03.955 INFO: Distance transform for radial basis functions: None
2025-04-10 15:29:04.888 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:29:04.889 INFO: Total number of parameters: 68960
2025-04-10 15:29:04.889 INFO: 
2025-04-10 15:29:04.889 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:29:04.889 INFO: Using ADAM as parameter optimizer
2025-04-10 15:29:04.889 INFO: Batch size: 10
2025-04-10 15:29:04.889 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:29:04.889 INFO: Number of gradient updates: 102000
2025-04-10 15:29:04.889 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:29:04.889 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:29:04.890 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:29:04.890 INFO: 
2025-04-10 15:29:04.890 INFO: ===========TRAINING===========
2025-04-10 15:29:04.890 INFO: Started training, reporting errors on validation set
2025-04-10 15:29:04.890 INFO: Loss metrics on validation set
2025-04-10 15:29:39.004 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:29:39.005 INFO: MACE version: 0.3.6
2025-04-10 15:29:39.005 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:29:39.031 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:29:39.048 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:39.055 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:39.067 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:29:39.073 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:29:39.073 INFO: 
2025-04-10 15:29:39.073 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:29:39.208 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:29:39.208 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:29:39.209 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:29:39.209 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:29:39.209 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:29:39.212 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:29:39.303 INFO: 
2025-04-10 15:29:39.303 INFO: ===========MODEL DETAILS===========
2025-04-10 15:29:39.828 INFO: Average number of neighbors: 22.2
2025-04-10 15:29:39.828 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:29:39.901 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:29:39.901 INFO: Building model
2025-04-10 15:29:39.901 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:29:39.901 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:29:39.901 INFO: 8 radial and 5 basis functions
2025-04-10 15:29:39.901 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:29:39.901 INFO: Distance transform for radial basis functions: None
2025-04-10 15:29:40.896 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:29:40.896 INFO: Total number of parameters: 68960
2025-04-10 15:29:40.897 INFO: 
2025-04-10 15:29:40.897 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:29:40.897 INFO: Using ADAM as parameter optimizer
2025-04-10 15:29:40.897 INFO: Batch size: 10
2025-04-10 15:29:40.897 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:29:40.897 INFO: Number of gradient updates: 102000
2025-04-10 15:29:40.897 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:29:40.897 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:29:40.897 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:29:40.898 INFO: 
2025-04-10 15:29:40.898 INFO: ===========TRAINING===========
2025-04-10 15:29:40.898 INFO: Started training, reporting errors on validation set
2025-04-10 15:29:40.898 INFO: Loss metrics on validation set
2025-04-10 15:29:54.385 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:29:54.385 INFO: MACE version: 0.3.6
2025-04-10 15:29:54.385 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:29:54.411 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:29:54.429 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:54.437 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:29:54.450 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:29:54.459 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:29:54.460 INFO: 
2025-04-10 15:29:54.460 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:29:54.597 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:29:54.597 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:29:54.598 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:29:54.598 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:29:54.598 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:29:54.601 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:29:54.692 INFO: 
2025-04-10 15:29:54.692 INFO: ===========MODEL DETAILS===========
2025-04-10 15:29:55.223 INFO: Average number of neighbors: 22.2
2025-04-10 15:29:55.223 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:29:55.296 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:29:55.296 INFO: Building model
2025-04-10 15:29:55.296 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:29:55.296 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:29:55.296 INFO: 8 radial and 5 basis functions
2025-04-10 15:29:55.296 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:29:55.296 INFO: Distance transform for radial basis functions: None
2025-04-10 15:29:56.285 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:29:56.286 INFO: Total number of parameters: 68960
2025-04-10 15:29:56.286 INFO: 
2025-04-10 15:29:56.286 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:29:56.286 INFO: Using ADAM as parameter optimizer
2025-04-10 15:29:56.286 INFO: Batch size: 10
2025-04-10 15:29:56.286 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:29:56.286 INFO: Number of gradient updates: 102000
2025-04-10 15:29:56.286 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:29:56.286 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:29:56.286 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:29:56.286 INFO: 
2025-04-10 15:29:56.286 INFO: ===========TRAINING===========
2025-04-10 15:29:56.286 INFO: Started training, reporting errors on validation set
2025-04-10 15:29:56.287 INFO: Loss metrics on validation set
2025-04-10 15:46:39.249 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:46:39.249 INFO: MACE version: 0.3.6
2025-04-10 15:46:39.249 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:46:39.275 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:46:39.293 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:46:39.302 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:46:39.314 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:46:39.325 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:46:39.326 INFO: 
2025-04-10 15:46:39.326 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:46:39.481 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:46:39.481 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:46:39.482 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:46:39.482 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:46:39.482 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:46:39.485 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:46:39.577 INFO: 
2025-04-10 15:46:39.577 INFO: ===========MODEL DETAILS===========
2025-04-10 15:46:40.080 INFO: Average number of neighbors: 22.2
2025-04-10 15:46:40.080 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:46:40.148 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:46:40.148 INFO: Building model
2025-04-10 15:46:40.148 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:46:40.148 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:46:40.148 INFO: 8 radial and 5 basis functions
2025-04-10 15:46:40.148 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:46:40.148 INFO: Distance transform for radial basis functions: None
2025-04-10 15:46:40.975 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:46:40.976 INFO: Total number of parameters: 68960
2025-04-10 15:46:40.976 INFO: 
2025-04-10 15:46:40.976 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:46:40.976 INFO: Using ADAM as parameter optimizer
2025-04-10 15:46:40.976 INFO: Batch size: 10
2025-04-10 15:46:40.976 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:46:40.976 INFO: Number of gradient updates: 102000
2025-04-10 15:46:40.976 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:46:40.976 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:46:40.977 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:46:40.977 INFO: 
2025-04-10 15:46:40.977 INFO: ===========TRAINING===========
2025-04-10 15:46:40.977 INFO: Started training, reporting errors on validation set
2025-04-10 15:46:40.977 INFO: Loss metrics on validation set
2025-04-10 15:47:16.049 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:47:16.049 INFO: MACE version: 0.3.6
2025-04-10 15:47:16.049 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:47:16.076 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:47:16.094 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:47:16.102 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:47:16.114 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:47:16.120 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:47:16.120 INFO: 
2025-04-10 15:47:16.120 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:47:16.264 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:47:16.264 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:47:16.265 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:47:16.265 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:47:16.265 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:47:16.268 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:47:16.359 INFO: 
2025-04-10 15:47:16.359 INFO: ===========MODEL DETAILS===========
2025-04-10 15:47:16.878 INFO: Average number of neighbors: 22.2
2025-04-10 15:47:16.878 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:47:16.952 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:47:16.952 INFO: Building model
2025-04-10 15:47:16.952 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:47:16.952 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:47:16.952 INFO: 8 radial and 5 basis functions
2025-04-10 15:47:16.952 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:47:16.952 INFO: Distance transform for radial basis functions: None
2025-04-10 15:47:17.830 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:47:17.831 INFO: Total number of parameters: 68960
2025-04-10 15:47:17.831 INFO: 
2025-04-10 15:47:17.831 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:47:17.831 INFO: Using ADAM as parameter optimizer
2025-04-10 15:47:17.831 INFO: Batch size: 10
2025-04-10 15:47:17.831 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:47:17.831 INFO: Number of gradient updates: 102000
2025-04-10 15:47:17.831 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:47:17.831 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:47:17.832 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:47:17.832 INFO: 
2025-04-10 15:47:17.832 INFO: ===========TRAINING===========
2025-04-10 15:47:17.832 INFO: Started training, reporting errors on validation set
2025-04-10 15:47:17.832 INFO: Loss metrics on validation set
2025-04-10 15:48:16.575 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:48:16.575 INFO: MACE version: 0.3.6
2025-04-10 15:48:16.575 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:48:16.601 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:48:16.619 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:16.627 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:16.639 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:48:16.645 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:48:16.646 INFO: 
2025-04-10 15:48:16.646 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:48:16.792 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:48:16.792 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:48:16.792 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:48:16.792 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:48:16.792 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:48:16.795 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:48:16.887 INFO: 
2025-04-10 15:48:16.887 INFO: ===========MODEL DETAILS===========
2025-04-10 15:48:17.409 INFO: Average number of neighbors: 22.2
2025-04-10 15:48:17.409 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:48:17.482 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:48:17.482 INFO: Building model
2025-04-10 15:48:17.482 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:48:17.482 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:48:17.482 INFO: 8 radial and 5 basis functions
2025-04-10 15:48:17.483 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:48:17.483 INFO: Distance transform for radial basis functions: None
2025-04-10 15:48:18.402 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:48:18.403 INFO: Total number of parameters: 68960
2025-04-10 15:48:18.403 INFO: 
2025-04-10 15:48:18.403 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:48:18.403 INFO: Using ADAM as parameter optimizer
2025-04-10 15:48:18.403 INFO: Batch size: 10
2025-04-10 15:48:18.403 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:48:18.404 INFO: Number of gradient updates: 102000
2025-04-10 15:48:18.404 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:48:18.404 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:48:18.404 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:48:18.404 INFO: 
2025-04-10 15:48:18.404 INFO: ===========TRAINING===========
2025-04-10 15:48:18.404 INFO: Started training, reporting errors on validation set
2025-04-10 15:48:18.404 INFO: Loss metrics on validation set
2025-04-10 15:48:25.649 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:48:25.649 INFO: MACE version: 0.3.6
2025-04-10 15:48:25.649 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:48:25.675 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:48:25.693 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:25.701 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:25.713 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:48:25.719 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:48:25.719 INFO: 
2025-04-10 15:48:25.719 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:48:25.864 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:48:25.864 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:48:25.864 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:48:25.864 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:48:25.864 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:48:25.867 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:48:25.958 INFO: 
2025-04-10 15:48:25.958 INFO: ===========MODEL DETAILS===========
2025-04-10 15:48:26.474 INFO: Average number of neighbors: 22.2
2025-04-10 15:48:26.475 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:48:26.547 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:48:26.547 INFO: Building model
2025-04-10 15:48:26.547 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:48:26.547 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:48:26.547 INFO: 8 radial and 5 basis functions
2025-04-10 15:48:26.547 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:48:26.547 INFO: Distance transform for radial basis functions: None
2025-04-10 15:48:27.472 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:48:27.473 INFO: Total number of parameters: 68960
2025-04-10 15:48:27.473 INFO: 
2025-04-10 15:48:27.473 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:48:27.473 INFO: Using ADAM as parameter optimizer
2025-04-10 15:48:27.473 INFO: Batch size: 10
2025-04-10 15:48:27.473 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:48:27.473 INFO: Number of gradient updates: 102000
2025-04-10 15:48:27.473 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:48:27.474 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:48:27.474 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:48:27.474 INFO: 
2025-04-10 15:48:27.474 INFO: ===========TRAINING===========
2025-04-10 15:48:27.474 INFO: Started training, reporting errors on validation set
2025-04-10 15:48:27.474 INFO: Loss metrics on validation set
2025-04-10 15:48:55.934 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:48:55.934 INFO: MACE version: 0.3.6
2025-04-10 15:48:55.934 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=4, n_nacs=4, n_socs=10, n_dipoles=11, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:48:55.961 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:48:55.980 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:55.988 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:48:56.000 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:48:56.006 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:48:56.006 INFO: 
2025-04-10 15:48:56.006 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:48:56.152 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:48:56.152 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:48:56.153 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:48:56.153 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:48:56.153 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:48:56.156 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:48:56.247 INFO: 
2025-04-10 15:48:56.247 INFO: ===========MODEL DETAILS===========
2025-04-10 15:48:56.770 INFO: Average number of neighbors: 22.2
2025-04-10 15:48:56.770 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:48:56.842 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:48:56.843 INFO: Building model
2025-04-10 15:48:56.843 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:48:56.843 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:48:56.843 INFO: 8 radial and 5 basis functions
2025-04-10 15:48:56.843 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:48:56.843 INFO: Distance transform for radial basis functions: None
2025-04-10 15:48:57.760 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 7x0e+25x1o | 512 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 7x0e+25x1o | 112 weights)
    )
  )
)
2025-04-10 15:48:57.761 INFO: Total number of parameters: 68960
2025-04-10 15:48:57.761 INFO: 
2025-04-10 15:48:57.761 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:48:57.761 INFO: Using ADAM as parameter optimizer
2025-04-10 15:48:57.761 INFO: Batch size: 10
2025-04-10 15:48:57.761 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:48:57.761 INFO: Number of gradient updates: 102000
2025-04-10 15:48:57.761 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:48:57.761 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:48:57.761 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:48:57.762 INFO: 
2025-04-10 15:48:57.762 INFO: ===========TRAINING===========
2025-04-10 15:48:57.762 INFO: Started training, reporting errors on validation set
2025-04-10 15:48:57.762 INFO: Loss metrics on validation set
2025-04-10 15:49:17.007 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:49:17.007 INFO: MACE version: 0.3.6
2025-04-10 15:49:17.007 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:49:17.033 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:49:17.051 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:49:17.059 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:49:17.071 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:49:17.077 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:49:17.077 INFO: 
2025-04-10 15:49:17.077 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:49:17.222 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:49:17.222 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:49:17.222 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:49:17.222 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:49:17.222 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:49:17.225 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:49:17.317 INFO: 
2025-04-10 15:49:17.317 INFO: ===========MODEL DETAILS===========
2025-04-10 15:49:17.819 INFO: Average number of neighbors: 22.2
2025-04-10 15:49:17.819 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:49:17.857 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:49:17.857 INFO: Building model
2025-04-10 15:49:17.857 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:49:17.857 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:49:17.857 INFO: 8 radial and 5 basis functions
2025-04-10 15:49:17.857 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:49:17.857 INFO: Distance transform for radial basis functions: None
2025-04-10 15:49:18.732 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 23x0e+131x1o | 2464 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 23x0e+131x1o | 368 weights)
    )
  )
)
2025-04-10 15:49:18.733 INFO: Total number of parameters: 71168
2025-04-10 15:49:18.733 INFO: 
2025-04-10 15:49:18.733 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:49:18.733 INFO: Using ADAM as parameter optimizer
2025-04-10 15:49:18.733 INFO: Batch size: 10
2025-04-10 15:49:18.733 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:49:18.733 INFO: Number of gradient updates: 102000
2025-04-10 15:49:18.733 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:49:18.733 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:49:18.734 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:49:18.734 INFO: 
2025-04-10 15:49:18.734 INFO: ===========TRAINING===========
2025-04-10 15:49:18.734 INFO: Started training, reporting errors on validation set
2025-04-10 15:49:18.734 INFO: Loss metrics on validation set
2025-04-10 15:49:49.936 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:49:49.936 INFO: MACE version: 0.3.6
2025-04-10 15:49:49.936 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=3, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:49:49.963 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:49:49.981 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:49:49.989 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:49:50.001 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:49:50.007 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:49:50.007 INFO: 
2025-04-10 15:49:50.007 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:49:50.152 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:49:50.152 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:49:50.152 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:49:50.152 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:49:50.152 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:49:50.155 INFO: Atomic Energies used (z: eV): {1: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 35: 0.0, 53: 0.0}
2025-04-10 15:49:50.247 INFO: 
2025-04-10 15:49:50.247 INFO: ===========MODEL DETAILS===========
2025-04-10 15:49:50.748 INFO: Average number of neighbors: 22.2
2025-04-10 15:49:50.748 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:49:50.815 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:49:50.816 INFO: Building model
2025-04-10 15:49:50.816 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:49:50.816 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:49:50.816 INFO: 8 radial and 5 basis functions
2025-04-10 15:49:50.816 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:49:50.816 INFO: Distance transform for radial basis functions: None
2025-04-10 15:49:51.698 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 23x0e+131x1o | 2464 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 23x0e+131x1o | 368 weights)
    )
  )
)
2025-04-10 15:49:51.699 INFO: Total number of parameters: 71168
2025-04-10 15:49:51.699 INFO: 
2025-04-10 15:49:51.699 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:49:51.699 INFO: Using ADAM as parameter optimizer
2025-04-10 15:49:51.699 INFO: Batch size: 10
2025-04-10 15:49:51.699 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:49:51.699 INFO: Number of gradient updates: 102000
2025-04-10 15:49:51.699 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:49:51.700 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:49:51.700 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:49:51.700 INFO: 
2025-04-10 15:49:51.700 INFO: ===========TRAINING===========
2025-04-10 15:49:51.700 INFO: Started training, reporting errors on validation set
2025-04-10 15:49:51.700 INFO: Loss metrics on validation set
2025-04-10 15:53:03.439 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:53:03.439 INFO: MACE version: 0.3.6
2025-04-10 15:53:03.439 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:53:03.465 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:53:03.483 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:53:03.491 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:53:03.503 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:53:03.514 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:53:03.514 INFO: 
2025-04-10 15:53:03.514 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:53:03.671 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:53:03.671 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:53:03.672 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:53:03.672 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:53:03.672 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:53:03.675 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 15:53:03.766 INFO: 
2025-04-10 15:53:03.766 INFO: ===========MODEL DETAILS===========
2025-04-10 15:53:04.274 INFO: Average number of neighbors: 22.2
2025-04-10 15:53:04.274 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:53:04.322 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:53:04.322 INFO: Building model
2025-04-10 15:53:04.322 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:53:04.322 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:53:04.322 INFO: 8 radial and 5 basis functions
2025-04-10 15:53:04.322 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:53:04.322 INFO: Distance transform for radial basis functions: None
2025-04-10 15:53:05.215 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 41x0e+131x1o | 2752 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 41x0e+131x1o | 656 weights)
    )
  )
)
2025-04-10 15:53:05.216 INFO: Total number of parameters: 71744
2025-04-10 15:53:05.216 INFO: 
2025-04-10 15:53:05.216 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:53:05.216 INFO: Using ADAM as parameter optimizer
2025-04-10 15:53:05.216 INFO: Batch size: 10
2025-04-10 15:53:05.216 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:53:05.217 INFO: Number of gradient updates: 102000
2025-04-10 15:53:05.217 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:53:05.217 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:53:05.217 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:53:05.217 INFO: 
2025-04-10 15:53:05.217 INFO: ===========TRAINING===========
2025-04-10 15:53:05.217 INFO: Started training, reporting errors on validation set
2025-04-10 15:53:05.217 INFO: Loss metrics on validation set
2025-04-10 15:53:05.798 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:08.393 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:10.878 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:11.267 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:14.280 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:14.652 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:14.924 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:15.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:15.576 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:15.888 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:16.251 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:16.711 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:17.048 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:17.371 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:17.690 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:18.037 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:18.356 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:18.651 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:19.085 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:19.414 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:19.770 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:22.763 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:22.764 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 15:53:23.155 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:23.444 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:23.784 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:24.060 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:24.366 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:24.728 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:25.066 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:25.462 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:25.840 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:53:26.199 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:54:22.797 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:54:22.797 INFO: MACE version: 0.3.6
2025-04-10 15:54:22.797 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:54:22.824 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:54:22.842 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:54:22.850 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:54:22.864 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:54:22.872 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:54:22.873 INFO: 
2025-04-10 15:54:22.873 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:54:23.028 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:54:23.028 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:54:23.029 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:54:23.029 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:54:23.029 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:54:23.032 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 15:54:23.124 INFO: 
2025-04-10 15:54:23.124 INFO: ===========MODEL DETAILS===========
2025-04-10 15:54:23.672 INFO: Average number of neighbors: 22.2
2025-04-10 15:54:23.672 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:54:23.745 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:54:23.745 INFO: Building model
2025-04-10 15:54:23.745 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:54:23.745 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:54:23.745 INFO: 8 radial and 5 basis functions
2025-04-10 15:54:23.745 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:54:23.745 INFO: Distance transform for radial basis functions: None
2025-04-10 15:54:24.681 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 41x0e+131x1o | 2752 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 41x0e+131x1o | 656 weights)
    )
  )
)
2025-04-10 15:54:24.681 INFO: Total number of parameters: 71744
2025-04-10 15:54:24.682 INFO: 
2025-04-10 15:54:24.682 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:54:24.682 INFO: Using ADAM as parameter optimizer
2025-04-10 15:54:24.682 INFO: Batch size: 10
2025-04-10 15:54:24.682 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:54:24.682 INFO: Number of gradient updates: 102000
2025-04-10 15:54:24.682 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:54:24.682 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:54:24.682 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:54:24.682 INFO: 
2025-04-10 15:54:24.682 INFO: ===========TRAINING===========
2025-04-10 15:54:24.682 INFO: Started training, reporting errors on validation set
2025-04-10 15:54:24.682 INFO: Loss metrics on validation set
2025-04-10 15:54:25.261 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:54:27.837 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:12.138 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:55:12.138 INFO: MACE version: 0.3.6
2025-04-10 15:55:12.138 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='16x0e + 16x1o', num_channels=16, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:55:12.164 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:55:12.182 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:55:12.191 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:55:12.204 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:55:12.217 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:55:12.218 INFO: 
2025-04-10 15:55:12.218 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:55:12.382 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:55:12.382 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:55:12.383 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:55:12.383 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:55:12.383 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:55:12.386 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 15:55:12.478 INFO: 
2025-04-10 15:55:12.479 INFO: ===========MODEL DETAILS===========
2025-04-10 15:55:12.999 INFO: Average number of neighbors: 22.2
2025-04-10 15:55:12.999 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:55:13.072 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:55:13.072 INFO: Building model
2025-04-10 15:55:13.072 INFO: Message passing with 16 channels and max_L=1 (16x0e + 16x1o)
2025-04-10 15:55:13.072 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:55:13.072 INFO: 8 radial and 5 basis functions
2025-04-10 15:55:13.072 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:55:13.072 INFO: Distance transform for radial basis functions: None
2025-04-10 15:55:14.053 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 16x0e | 160 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 16x0e | 16 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(16x0e -> 16x0e | 256 weights)
      (conv_tp): TensorProduct(16x0e x 1x0e+1x1o+1x2e+1x3o -> 16x0e+16x1o+16x2e+16x3o | 64 paths | 64 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 64]
      (linear): Linear(16x0e+16x1o+16x2e+16x3o -> 16x0e+16x1o+16x2e+16x3o | 1024 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o+16x2e+16x3o x 10x0e -> 16x0e+16x1o+16x2e+16x3o | 10240 paths | 10240 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
      (conv_tp): TensorProduct(16x0e+16x1o x 1x0e+1x1o+1x2e+1x3o -> 32x0e+48x1o+48x2e+32x3o | 160 paths | 160 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 160]
      (linear): Linear(32x0e+48x1o+48x2e+32x3o -> 16x0e+16x1o+16x2e+16x3o | 2560 weights)
      (skip_tp): FullyConnectedTensorProduct(16x0e+16x1o x 10x0e -> 16x0e | 2560 paths | 2560 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e+16x1o -> 16x0e+16x1o | 512 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x16 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x16 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(16x0e -> 16x0e | 256 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(16x0e+16x1o -> 41x0e+131x1o | 2752 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (16x0e -> 16x0e)
      (linear_1): Linear(16x0e -> 16x0e | 256 weights)
      (linear_2): Linear(16x0e -> 41x0e+131x1o | 656 weights)
    )
  )
)
2025-04-10 15:55:14.054 INFO: Total number of parameters: 71744
2025-04-10 15:55:14.054 INFO: 
2025-04-10 15:55:14.054 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:55:14.054 INFO: Using ADAM as parameter optimizer
2025-04-10 15:55:14.054 INFO: Batch size: 10
2025-04-10 15:55:14.054 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:55:14.054 INFO: Number of gradient updates: 102000
2025-04-10 15:55:14.054 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:55:14.054 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:55:14.055 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:55:14.055 INFO: 
2025-04-10 15:55:14.055 INFO: ===========TRAINING===========
2025-04-10 15:55:14.055 INFO: Started training, reporting errors on validation set
2025-04-10 15:55:14.055 INFO: Loss metrics on validation set
2025-04-10 15:55:14.635 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:17.210 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:19.696 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:20.097 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:23.095 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:23.476 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:23.751 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:24.077 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:24.406 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:24.720 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:25.087 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:25.551 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:25.889 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:26.215 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:26.536 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:26.886 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:27.206 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:27.504 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:27.947 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:28.281 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:28.638 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:31.643 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:31.644 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 15:55:32.047 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:32.338 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:32.678 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:32.955 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:33.263 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:33.625 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:33.964 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:34.361 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:34.739 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:35.099 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:35.478 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:35.870 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:36.281 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:36.643 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:36.984 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:37.247 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:37.552 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:37.904 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:38.216 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:38.496 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:38.629 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:38.631 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 15:55:38.631 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 15:55:38.962 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:39.279 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:39.684 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:40.136 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:40.412 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:40.754 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:41.143 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:41.500 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:41.892 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:42.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:42.519 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:42.952 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:43.224 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:43.507 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:43.805 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:44.203 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:44.496 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:44.767 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:45.050 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:45.383 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:45.518 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:45.520 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 15:55:45.520 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-2.pt
2025-04-10 15:55:45.988 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:46.403 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:46.713 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:47.027 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:47.323 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:47.699 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:48.112 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:48.401 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:48.647 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:49.050 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:49.406 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:49.706 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:50.009 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:50.278 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:50.652 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:51.075 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:51.383 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:51.653 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:52.042 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:52.372 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:52.508 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:52.510 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-2.pt
2025-04-10 15:55:52.510 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-3.pt
2025-04-10 15:55:52.933 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:53.196 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:53.552 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:53.957 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:54.276 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:54.639 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:54.993 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:55.361 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:55.627 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:56.006 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:56.260 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:56.632 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:57.011 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:57.335 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:57.595 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:57.956 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:58.378 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:58.771 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:59.024 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:59.349 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:59.485 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:55:59.486 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-3.pt
2025-04-10 15:55:59.487 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-4.pt
2025-04-10 15:55:59.836 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:00.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:00.583 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:00.939 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:01.295 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:01.526 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:01.911 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:02.176 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:02.496 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:02.792 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:03.124 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:03.503 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:03.925 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:04.280 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:04.706 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:05.138 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:05.493 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:05.819 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:06.084 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:06.373 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:06.507 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:06.508 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-4.pt
2025-04-10 15:56:06.509 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-5.pt
2025-04-10 15:56:06.957 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:07.410 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:07.705 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:07.995 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:08.315 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:08.736 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:09.076 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:09.544 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:09.828 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:10.111 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:10.342 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:10.676 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:11.051 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:11.469 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:11.868 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:12.205 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:12.600 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:12.882 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:13.120 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:13.417 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:13.551 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:13.552 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-5.pt
2025-04-10 15:56:13.553 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-6.pt
2025-04-10 15:56:14.016 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:14.361 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:14.698 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:15.067 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:15.393 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:15.715 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:16.090 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:16.449 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:16.799 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:17.175 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:17.551 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:17.845 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:18.164 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:18.509 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:18.901 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:19.180 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:19.622 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:19.984 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:20.217 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:20.517 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:20.651 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:20.653 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-6.pt
2025-04-10 15:56:20.654 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-7.pt
2025-04-10 15:56:21.103 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:21.476 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:21.805 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:22.108 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:22.512 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:22.782 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:23.109 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:23.504 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:23.954 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:24.300 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:24.651 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:24.900 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:25.323 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:25.629 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:25.915 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:26.266 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:26.592 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:26.959 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:27.347 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:27.614 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:27.751 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:27.753 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-7.pt
2025-04-10 15:56:27.753 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-8.pt
2025-04-10 15:56:28.131 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:28.501 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:28.791 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:29.211 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:29.517 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:29.890 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:30.288 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:30.615 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:30.929 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:31.307 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:31.651 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:32.026 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:32.319 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:32.730 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:33.040 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:33.433 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:33.706 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:34.030 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:34.406 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:34.713 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:34.845 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:34.847 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-8.pt
2025-04-10 15:56:34.847 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-9.pt
2025-04-10 15:56:35.277 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:35.611 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:35.903 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:36.174 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:36.509 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:36.783 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:37.143 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:37.443 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:37.756 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:38.110 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:38.489 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:38.917 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:39.299 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:39.694 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:40.052 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:40.494 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:40.837 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:41.176 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:41.451 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:41.731 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:41.868 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:41.870 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-9.pt
2025-04-10 15:56:41.870 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-10.pt
2025-04-10 15:56:42.333 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:42.609 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:42.874 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:43.201 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:43.548 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:56:43.832 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:57:20.723 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:57:20.723 INFO: MACE version: 0.3.6
2025-04-10 15:57:20.723 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='128x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:57:20.750 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:57:20.768 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:57:20.775 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:57:20.787 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:57:20.793 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:57:20.793 INFO: 
2025-04-10 15:57:20.793 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:57:20.947 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:57:20.947 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:57:20.948 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:57:20.948 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:57:20.948 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:57:20.951 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 15:57:21.042 INFO: 
2025-04-10 15:57:21.042 INFO: ===========MODEL DETAILS===========
2025-04-10 15:57:21.551 INFO: Average number of neighbors: 22.2
2025-04-10 15:57:21.551 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:57:21.604 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:57:21.604 INFO: Building model
2025-04-10 15:57:21.604 INFO: Message passing with 128 channels and max_L=1 (128x0e + 128x1o)
2025-04-10 15:57:21.604 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:57:21.604 INFO: 8 radial and 5 basis functions
2025-04-10 15:57:21.604 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:57:21.604 INFO: Distance transform for radial basis functions: None
2025-04-10 15:57:22.570 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 128x0e | 1280 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 128x0e | 128 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e+128x3o x 10x0e -> 128x0e+128x1o+128x2e+128x3o | 655360 paths | 655360 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
      (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 10x0e -> 128x0e | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(128x0e+128x1o -> 41x0e+131x1o | 22016 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (128x0e -> 128x0e)
      (linear_1): Linear(128x0e -> 128x0e | 16384 weights)
      (linear_2): Linear(128x0e -> 41x0e+131x1o | 5248 weights)
    )
  )
)
2025-04-10 15:57:22.571 INFO: Total number of parameters: 1469952
2025-04-10 15:57:22.571 INFO: 
2025-04-10 15:57:22.571 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:57:22.571 INFO: Using ADAM as parameter optimizer
2025-04-10 15:57:22.571 INFO: Batch size: 5
2025-04-10 15:57:22.571 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:57:22.571 INFO: Number of gradient updates: 204000
2025-04-10 15:57:22.572 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:57:22.572 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:57:22.572 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:57:22.572 INFO: 
2025-04-10 15:57:22.572 INFO: ===========TRAINING===========
2025-04-10 15:57:22.572 INFO: Started training, reporting errors on validation set
2025-04-10 15:57:22.572 INFO: Loss metrics on validation set
2025-04-10 15:57:23.374 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:57:26.454 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:57:29.527 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:57:30.489 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:57:31.257 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:58:03.473 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 15:58:03.473 INFO: MACE version: 0.3.6
2025-04-10 15:58:03.473 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='128x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 15:58:03.634 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 15:58:03.653 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:58:03.661 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 15:58:03.673 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 15:58:03.679 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 15:58:03.679 INFO: 
2025-04-10 15:58:03.679 INFO: ===========LOADING INPUT DATA===========
2025-04-10 15:58:03.835 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 15:58:03.835 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 15:58:03.836 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 15:58:03.836 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 15:58:03.836 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 15:58:03.839 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 15:58:03.930 INFO: 
2025-04-10 15:58:03.930 INFO: ===========MODEL DETAILS===========
2025-04-10 15:58:04.436 INFO: Average number of neighbors: 22.2
2025-04-10 15:58:04.436 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 15:58:04.488 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 15:58:04.488 INFO: Building model
2025-04-10 15:58:04.488 INFO: Message passing with 128 channels and max_L=1 (128x0e + 128x1o)
2025-04-10 15:58:04.488 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 15:58:04.488 INFO: 8 radial and 5 basis functions
2025-04-10 15:58:04.488 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 15:58:04.488 INFO: Distance transform for radial basis functions: None
2025-04-10 15:58:05.426 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 128x0e | 1280 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 128x0e | 128 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e+128x3o x 10x0e -> 128x0e+128x1o+128x2e+128x3o | 655360 paths | 655360 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
      (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 10x0e -> 128x0e | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x128 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x128 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(128x0e+128x1o -> 41x0e+131x1o | 22016 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (128x0e -> 128x0e)
      (linear_1): Linear(128x0e -> 128x0e | 16384 weights)
      (linear_2): Linear(128x0e -> 41x0e+131x1o | 5248 weights)
    )
  )
)
2025-04-10 15:58:05.427 INFO: Total number of parameters: 1469952
2025-04-10 15:58:05.427 INFO: 
2025-04-10 15:58:05.427 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 15:58:05.427 INFO: Using ADAM as parameter optimizer
2025-04-10 15:58:05.427 INFO: Batch size: 5
2025-04-10 15:58:05.427 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 15:58:05.427 INFO: Number of gradient updates: 204000
2025-04-10 15:58:05.427 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 15:58:05.427 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 15:58:05.428 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 15:58:05.428 INFO: 
2025-04-10 15:58:05.428 INFO: ===========TRAINING===========
2025-04-10 15:58:05.428 INFO: Started training, reporting errors on validation set
2025-04-10 15:58:05.428 INFO: Loss metrics on validation set
2025-04-10 15:58:06.242 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 15:58:09.323 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:10.020 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:02:10.020 INFO: MACE version: 0.3.6
2025-04-10 16:02:10.020 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:02:10.185 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:02:10.203 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:02:10.211 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:02:10.223 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:02:10.229 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:02:10.229 INFO: 
2025-04-10 16:02:10.229 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:02:10.383 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:02:10.383 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:02:10.384 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:02:10.384 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:02:10.384 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:02:10.387 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:02:10.478 INFO: 
2025-04-10 16:02:10.479 INFO: ===========MODEL DETAILS===========
2025-04-10 16:02:10.976 INFO: Average number of neighbors: 22.2
2025-04-10 16:02:10.976 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 16:02:11.028 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 16:02:11.028 INFO: Building model
2025-04-10 16:02:11.028 INFO: Message passing with 64 channels and max_L=1 (64x0e + 64x1o)
2025-04-10 16:02:11.028 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 16:02:11.028 INFO: 8 radial and 5 basis functions
2025-04-10 16:02:11.028 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 16:02:11.028 INFO: Distance transform for radial basis functions: None
2025-04-10 16:02:11.946 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 64x0e | 640 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 64x0e | 64 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e+64x3o x 10x0e -> 64x0e+64x1o+64x2e+64x3o | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(128x0e+192x1o+192x2e+128x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 10x0e -> 64x0e | 40960 paths | 40960 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 41x0e+131x1o | 11008 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (64x0e -> 64x0e)
      (linear_1): Linear(64x0e -> 64x0e | 4096 weights)
      (linear_2): Linear(64x0e -> 41x0e+131x1o | 2624 weights)
    )
  )
)
2025-04-10 16:02:11.947 INFO: Total number of parameters: 452864
2025-04-10 16:02:11.947 INFO: 
2025-04-10 16:02:11.947 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 16:02:11.947 INFO: Using ADAM as parameter optimizer
2025-04-10 16:02:11.947 INFO: Batch size: 5
2025-04-10 16:02:11.947 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 16:02:11.948 INFO: Number of gradient updates: 204000
2025-04-10 16:02:11.948 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 16:02:11.948 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 16:02:11.948 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 16:02:11.948 INFO: 
2025-04-10 16:02:11.948 INFO: ===========TRAINING===========
2025-04-10 16:02:11.948 INFO: Started training, reporting errors on validation set
2025-04-10 16:02:11.948 INFO: Loss metrics on validation set
2025-04-10 16:02:12.617 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:15.436 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:18.182 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:18.605 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:19.004 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:22.526 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:22.916 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:23.341 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:23.744 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:24.323 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:24.888 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:27.897 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:28.415 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:28.914 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:29.405 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:30.013 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:30.402 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:30.927 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:31.366 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:31.946 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:32.463 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:33.018 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:34.093 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:34.730 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:35.119 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:35.578 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:36.112 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:36.600 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:37.091 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:37.665 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:38.152 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:38.545 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:39.139 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:39.617 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:40.054 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:40.709 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:41.406 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:41.933 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:42.424 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:43.060 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:43.516 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:43.728 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:43.729 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 16:02:44.233 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:44.773 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:45.218 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:45.672 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:46.078 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:46.712 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:47.158 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:47.571 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:48.005 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:48.525 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:49.210 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:49.641 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:50.383 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:50.685 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:51.276 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:51.916 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:52.445 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:53.078 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:53.522 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:54.180 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:54.876 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:55.354 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:55.751 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:56.565 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:57.228 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:57.835 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:58.398 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:58.946 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:59.486 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:02:59.997 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:00.340 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:00.814 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:01.347 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:01.762 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:02.312 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:02.849 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:03.298 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:03.807 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:04.167 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:04.682 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:04.889 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:04.890 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 16:03:04.891 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 16:03:05.298 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:05.840 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:06.245 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:06.818 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:07.433 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:08.082 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:08.787 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:09.487 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:09.805 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:10.349 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:10.966 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:11.415 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:11.914 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:12.621 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:13.127 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:13.720 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:14.222 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:14.940 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:15.521 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:16.040 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:16.471 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:16.886 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:17.671 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:18.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:18.535 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:19.094 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:19.462 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:19.975 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:20.419 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:20.905 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:21.606 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:22.136 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:22.541 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:23.040 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:23.461 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:23.884 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:24.306 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:24.766 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:25.288 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:25.788 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:25.997 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:25.998 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 16:03:25.999 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-2.pt
2025-04-10 16:03:26.594 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:27.373 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:28.085 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:28.680 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:29.130 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:29.639 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:30.370 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:30.629 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:31.007 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:31.565 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:32.106 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:32.723 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:33.341 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:34.005 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:34.424 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:34.902 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:35.366 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:35.673 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:36.233 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:36.931 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:37.482 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:38.037 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:38.559 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:38.975 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:39.488 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:39.914 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:40.302 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:40.753 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:41.488 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:41.928 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:42.593 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:43.254 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:43.730 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:44.208 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:44.593 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:45.056 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:45.768 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:46.267 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:46.593 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:47.308 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:47.520 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:47.522 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-2.pt
2025-04-10 16:03:47.523 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-3.pt
2025-04-10 16:03:48.188 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:48.746 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:49.191 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:49.571 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:50.230 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:50.676 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:51.382 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:51.934 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:52.362 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:52.931 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:53.607 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:54.063 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:54.455 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:55.174 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:55.763 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:56.322 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:56.647 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:57.155 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:57.950 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:58.349 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:58.722 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:59.151 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:03:59.695 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:00.308 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:00.843 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:01.496 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:01.950 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:02.507 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:02.892 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:03.324 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:03.874 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:04.448 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:05.135 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:05.770 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:06.152 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:07.006 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:07.340 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:07.807 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:08.194 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:08.833 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:09.047 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:09.048 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-3.pt
2025-04-10 16:04:09.050 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-4.pt
2025-04-10 16:04:09.544 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:10.067 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:10.561 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:11.340 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:11.981 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:12.382 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:12.998 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:13.493 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:14.046 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:14.607 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:14.882 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:15.350 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:15.902 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:16.557 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:17.006 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:17.415 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:18.032 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:18.447 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:18.892 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:19.406 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:19.878 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:20.476 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:21.134 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:04:21.701 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:01.274 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:05:01.274 INFO: MACE version: 0.3.6
2025-04-10 16:05:01.274 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:05:01.301 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:05:01.319 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:05:01.326 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:05:01.338 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:05:01.343 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:05:01.343 INFO: 
2025-04-10 16:05:01.343 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:05:01.498 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:05:01.498 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:05:01.498 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:05:01.498 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:05:01.498 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:05:01.501 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:05:01.593 INFO: 
2025-04-10 16:05:01.593 INFO: ===========MODEL DETAILS===========
2025-04-10 16:05:45.415 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:05:45.415 INFO: MACE version: 0.3.6
2025-04-10 16:05:45.415 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:05:45.586 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:05:45.604 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:05:45.613 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:05:45.625 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:05:45.631 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:05:45.631 INFO: 
2025-04-10 16:05:45.631 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:05:45.785 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:05:45.785 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:05:45.786 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:05:45.786 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:05:45.786 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:05:45.789 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:05:45.881 INFO: 
2025-04-10 16:05:45.881 INFO: ===========MODEL DETAILS===========
2025-04-10 16:05:46.392 INFO: Average number of neighbors: 22.2
2025-04-10 16:05:46.392 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 16:05:46.444 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 16:05:46.445 INFO: Building model
2025-04-10 16:05:46.445 INFO: Message passing with 64 channels and max_L=1 (64x0e + 64x1o)
2025-04-10 16:05:46.445 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 16:05:46.445 INFO: 8 radial and 5 basis functions
2025-04-10 16:05:46.445 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 16:05:46.445 INFO: Distance transform for radial basis functions: None
2025-04-10 16:05:47.397 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 64x0e | 640 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 64x0e | 64 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e+64x3o x 10x0e -> 64x0e+64x1o+64x2e+64x3o | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(128x0e+192x1o+192x2e+128x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 10x0e -> 64x0e | 40960 paths | 40960 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 41x0e+131x1o | 11008 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (64x0e -> 64x0e)
      (linear_1): Linear(64x0e -> 64x0e | 4096 weights)
      (linear_2): Linear(64x0e -> 41x0e+131x1o | 2624 weights)
    )
  )
)
2025-04-10 16:05:47.398 INFO: Total number of parameters: 452864
2025-04-10 16:05:47.398 INFO: 
2025-04-10 16:05:47.398 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 16:05:47.398 INFO: Using ADAM as parameter optimizer
2025-04-10 16:05:47.398 INFO: Batch size: 5
2025-04-10 16:05:47.398 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 16:05:47.398 INFO: Number of gradient updates: 204000
2025-04-10 16:05:47.398 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 16:05:47.398 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 16:05:47.399 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 16:05:47.399 INFO: 
2025-04-10 16:05:47.399 INFO: ===========TRAINING===========
2025-04-10 16:05:47.399 INFO: Started training, reporting errors on validation set
2025-04-10 16:05:47.399 INFO: Loss metrics on validation set
2025-04-10 16:05:48.053 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:50.868 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:53.605 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:54.027 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:54.429 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:57.928 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:58.321 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:58.748 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:59.155 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:05:59.736 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:00.305 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:03.312 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:03.835 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:04.336 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:04.833 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:05.447 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:05.839 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:06.368 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:06.810 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:07.394 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:07.917 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:08.476 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:09.557 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:10.196 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:10.589 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:11.052 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:11.588 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:12.082 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:12.577 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:13.157 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:13.648 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:06:14.037 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:13.856 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:08:13.856 INFO: MACE version: 0.3.6
2025-04-10 16:08:13.857 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:08:14.022 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:08:14.039 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:08:14.048 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:08:14.060 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:08:14.066 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:08:14.066 INFO: 
2025-04-10 16:08:14.066 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:08:14.219 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:08:14.219 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:08:14.220 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:08:14.220 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:08:14.220 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:08:14.223 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:08:14.314 INFO: 
2025-04-10 16:08:14.315 INFO: ===========MODEL DETAILS===========
2025-04-10 16:08:14.827 INFO: Average number of neighbors: 22.2
2025-04-10 16:08:14.827 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 16:08:14.879 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 16:08:14.879 INFO: Building model
2025-04-10 16:08:14.879 INFO: Message passing with 64 channels and max_L=1 (64x0e + 64x1o)
2025-04-10 16:08:14.879 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 16:08:14.879 INFO: 8 radial and 5 basis functions
2025-04-10 16:08:14.879 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 16:08:14.879 INFO: Distance transform for radial basis functions: None
2025-04-10 16:08:15.728 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 64x0e | 640 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 64x0e | 64 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e+64x3o x 10x0e -> 64x0e+64x1o+64x2e+64x3o | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(128x0e+192x1o+192x2e+128x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 10x0e -> 64x0e | 40960 paths | 40960 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 41x0e+131x1o | 11008 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (64x0e -> 64x0e)
      (linear_1): Linear(64x0e -> 64x0e | 4096 weights)
      (linear_2): Linear(64x0e -> 41x0e+131x1o | 2624 weights)
    )
  )
)
2025-04-10 16:08:15.729 INFO: Total number of parameters: 452864
2025-04-10 16:08:15.729 INFO: 
2025-04-10 16:08:15.729 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 16:08:15.729 INFO: Using ADAM as parameter optimizer
2025-04-10 16:08:15.729 INFO: Batch size: 5
2025-04-10 16:08:15.729 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 16:08:15.729 INFO: Number of gradient updates: 204000
2025-04-10 16:08:15.729 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 16:08:15.729 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 16:08:15.730 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 16:08:15.730 INFO: 
2025-04-10 16:08:15.730 INFO: ===========TRAINING===========
2025-04-10 16:08:15.730 INFO: Started training, reporting errors on validation set
2025-04-10 16:08:15.730 INFO: Loss metrics on validation set
2025-04-10 16:08:16.394 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:19.216 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:21.958 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:22.383 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:22.789 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:26.292 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:26.688 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:27.120 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:27.529 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:28.117 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:28.691 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:31.699 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:32.225 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:32.732 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:33.235 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:33.855 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:34.252 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:34.785 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:35.231 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:35.821 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:36.348 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:36.914 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:38.004 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:38.649 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:39.045 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:39.510 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:40.051 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:40.548 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:41.046 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:41.631 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:42.127 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:42.519 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:43.121 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:43.607 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:44.052 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:44.715 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:45.424 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:45.958 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:46.457 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:47.103 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:47.567 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:47.783 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:47.785 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 16:08:48.295 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:48.843 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:49.296 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:49.757 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:50.170 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:50.813 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:51.266 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:51.685 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:52.128 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:52.655 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:53.350 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:53.788 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:54.544 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:54.851 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:55.451 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:56.101 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:56.638 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:57.279 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:57.731 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:58.399 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:59.109 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:59.593 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:08:59.996 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:00.829 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:01.502 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:02.120 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:02.692 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:03.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:03.796 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:04.313 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:04.661 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:05.142 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:05.689 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:06.111 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:06.669 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:07.214 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:07.669 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:08.186 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:08.551 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:09.072 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:09.283 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:09.284 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-0.pt
2025-04-10 16:09:09.286 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 16:09:09.698 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:10.248 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:10.667 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:11.252 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:11.877 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:12.537 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:13.254 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:13.965 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:14.289 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:14.841 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:15.469 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:15.926 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:16.432 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:17.150 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:17.663 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:18.267 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:18.776 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:19.504 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:20.093 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:20.622 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:21.062 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:21.485 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:22.278 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:22.863 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:23.154 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:23.722 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:24.096 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:24.619 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:25.071 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:25.565 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:26.274 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:26.813 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:27.225 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:27.733 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:28.162 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:28.593 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:29.023 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:29.493 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:30.024 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:30.533 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:30.746 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:30.747 DEBUG: Deleting old checkpoint file: ./checkpoints/chemo_run-100_epoch-1.pt
2025-04-10 16:09:30.748 DEBUG: Saving checkpoint: ./checkpoints/chemo_run-100_epoch-2.pt
2025-04-10 16:09:31.347 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:32.138 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:32.859 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:33.464 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:33.922 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:34.440 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:35.178 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:35.443 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:35.827 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:36.392 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:36.941 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:37.566 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:38.193 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:38.865 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:39.292 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:39.777 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:40.249 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:40.561 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:41.129 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:41.837 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:42.396 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:42.960 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:43.491 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:43.912 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:44.434 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:44.867 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:45.260 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:45.720 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:46.475 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:46.922 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:47.598 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:48.289 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:48.786 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:49.278 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:49.679 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:50.163 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:09:50.914 DEBUG: Saving info: ./results/chemo_run-100_train.txt
2025-04-10 16:17:12.234 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:17:12.234 INFO: MACE version: 0.3.6
2025-04-10 16:17:12.234 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:17:12.261 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:17:12.279 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:17:12.287 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:17:12.307 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:17:12.317 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:17:12.317 INFO: 
2025-04-10 16:17:12.317 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:17:12.473 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:17:12.473 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:17:12.473 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:17:12.473 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:17:12.474 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:17:12.476 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:17:12.568 INFO: 
2025-04-10 16:17:12.568 INFO: ===========MODEL DETAILS===========
2025-04-10 16:17:25.970 INFO: ===========VERIFYING SETTINGS===========
2025-04-10 16:17:25.970 INFO: MACE version: 0.3.6
2025-04-10 16:17:25.970 DEBUG: Configuration: Namespace(config=None, name='chemo', seed=100, work_dir='.', nacs_key='REF_nacs', scalar_key='REF_scalar', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, log_level='INFO', n_energies=21, n_oscillators=20, n_nacs=0, n_socs=110, n_dipoles=21, error_table='EnergyNacsDipoleMAE', model='EmbeddingEMACE', r_max=5.0, num_permutational_invariant=16, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='64x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e + 64x1o', num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_dipoles=True, compute_nacs=True, train_file='db_train_1_c.xyz', valid_file=None, valid_fraction=0.01, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipoles_key='REF_dipoles', socs_key='REF_socs', oscillator_key='REF_oscillator', loss='weighted', forces_weight=100.0, nacs_weight=100.0, oscillator_weight=100.0, socs_weight=100.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipoles_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=5, valid_batch_size=10, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=5000, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2025-04-10 16:17:26.102 INFO: CUDA version: 11.7, CUDA device: 0
2025-04-10 16:17:26.120 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:17:26.129 DEBUG: Popen(['git', 'version'], cwd=/home/rhyan/X-MACE, stdin=None, shell=False, universal_newlines=False)
2025-04-10 16:17:26.141 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/rhyan/X-MACE, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-04-10 16:17:26.146 DEBUG: Current Git commit: 0effad7b8a738f90222343f173cfed95ec00ebcb
2025-04-10 16:17:26.147 INFO: 
2025-04-10 16:17:26.147 INFO: ===========LOADING INPUT DATA===========
2025-04-10 16:17:26.299 INFO: Using random 1% of training set for validation with following indices: [43, 152]
2025-04-10 16:17:26.300 WARNING: Validation batch size (10) is larger than the number of validation data (2)
2025-04-10 16:17:26.300 INFO: Atomic Numbers used: [1, 6, 7, 8, 9, 15, 16, 17, 35, 53]
2025-04-10 16:17:26.300 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-04-10 16:17:26.300 INFO: Computing average Atomic Energies using least squares regression
2025-04-10 16:17:26.303 INFO: Atomic Energies used (z: eV): {1: -16.068749975162824, 6: -1037.4880822689886, 7: -1490.1562752865684, 8: -2048.0638303971637, 9: -2717.781411818248, 15: -9295.685578288983, 16: -10836.706604155792, 17: -12522.01989176472, 35: -70046.49666448025, 53: -196603.58169259518}
2025-04-10 16:17:26.395 INFO: 
2025-04-10 16:17:26.395 INFO: ===========MODEL DETAILS===========
2025-04-10 16:17:26.894 INFO: Average number of neighbors: 22.2
2025-04-10 16:17:26.894 INFO: During training the following quantities will be reported: energy, forces, dipoles, nacs
2025-04-10 16:17:26.946 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-04-10 16:17:26.946 INFO: Building model
2025-04-10 16:17:26.946 INFO: Message passing with 64 channels and max_L=1 (64x0e + 64x1o)
2025-04-10 16:17:26.946 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-10 16:17:26.946 INFO: 8 radial and 5 basis functions
2025-04-10 16:17:26.946 INFO: Radial cutoff: 5.0 Å (total receptive field for each atom: 10.0 Å)
2025-04-10 16:17:26.946 INFO: Distance transform for radial basis functions: None
2025-04-10 16:17:27.846 DEBUG: EmbeddingEMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(10x0e -> 64x0e | 640 weights)
  )
  (scalar_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(1x0e -> 64x0e | 64 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=5.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=5.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-16.0688, -1037.4880, -1490.1562, -2048.0637, -2717.7815, -9295.6855, -10836.7070, -12522.0195, -70046.5000, -196603.5781])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e+64x3o x 10x0e -> 64x0e+64x1o+64x2e+64x3o | 163840 paths | 163840 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(128x0e+192x1o+192x2e+128x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 10x0e -> 64x0e | 40960 paths | 40960 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x6x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 10x4x64 (GPU 0)]
                (1): Parameter containing: [torch.float32 of size 10x1x64 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearDipoleReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 41x0e+131x1o | 11008 weights)
    )
    (1): NonLinearDipoleReadoutBlock(
      (equivariant_nonlin): Gate (64x0e -> 64x0e)
      (linear_1): Linear(64x0e -> 64x0e | 4096 weights)
      (linear_2): Linear(64x0e -> 41x0e+131x1o | 2624 weights)
    )
  )
)
2025-04-10 16:17:27.847 INFO: Total number of parameters: 452864
2025-04-10 16:17:27.847 INFO: 
2025-04-10 16:17:27.847 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-10 16:17:27.847 INFO: Using ADAM as parameter optimizer
2025-04-10 16:17:27.847 INFO: Batch size: 5
2025-04-10 16:17:27.847 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-10 16:17:27.847 INFO: Number of gradient updates: 204000
2025-04-10 16:17:27.847 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-04-10 16:17:27.847 INFO: WeightedEnergyForcesNacsDipoleLoss(energy_weight=100.000, forces_weight=100.000, dipole_weight=1.000)
2025-04-10 16:17:27.848 INFO: Using gradient clipping with tolerance=10.000
2025-04-10 16:17:27.848 INFO: 
2025-04-10 16:17:27.848 INFO: ===========TRAINING===========
2025-04-10 16:17:27.848 INFO: Started training, reporting errors on validation set
2025-04-10 16:17:27.848 INFO: Loss metrics on validation set
2025-04-10 16:17:28.512 DEBUG: Saving info: ./results/chemo_run-100_train.txt
